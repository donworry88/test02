<!DOCTYPE html>
<html>
        <head>
<meta http-equiv="Cache-control" content="no-cache">
<meta http-equiv="Expires" content="-1">		
		
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		
<meta name="author" content="karu moon">
<meta name="description" content="LineStudy">
</head>
<body>
<a href="javascript:window.location.reload(true);">window location reload true</a>
<BR>
<input type='button' value='cccc' onclick='m_linebig.cccc()'>

        
<div id='aaabbc'>asdfaa <BR></div>
<canvas id="myCanvas" width="700" height="700" style="border:1px solid #d3d3d3; position:absolute;left:30px; top:30px;">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>
//prevent orientation event
var linebig=function(){
var self=this;
self.m_bi;
self.m_boxXS=90;
self.m_boxYS=90;
self.m_bxNum=4;
self.m_byNum=5;
function makeData2()
{
	self.m_bi=new Array(self.m_byNum);
	for(var i=0;i<self.m_byNum;i++){
		self.m_bi[i]=new Array(self.m_bxNum);
	}
	var n,chk=0;
	for(var i=0;i<self.m_byNum;i++)
	for(var j=0;j<self.m_bxNum;j++)
		self.m_bi[i][j]=999;
	
	for(var i=0;i<self.m_byNum;i++)
	for(var j=0;j<self.m_bxNum;j++)
	{	
		do{
			n=Math.floor(Math.random()*5);
			chk=0;
			if(i>0)if(self.m_bi[i-1][j]==n)chk=1;
			if(i<self.m_byNum-1)if(self.m_bi[i+1][j]==n)chk=1;
			if(j>0)if(self.m_bi[i][j-1]==n)chk=1;
			if(j<self.m_bxNum-1)if(self.m_bi[i][j+1]==n)chk=1;
		}while(chk==1);
		self.m_bi[i][j]=n;
	}
}
self.cccc=function()
{
	
	function cchk(n,i,j){
	    
	    var chk=0;
		if(i>0)if(self.m_bi[i-1][j]==n)chk=1;
		if(i<self.m_byNum-1)if(self.m_bi[i+1][j]==n)chk=1;
		if(j>0)if(self.m_bi[i][j-1]==n)chk=1;
		if(j<self.m_bxNum-1)if(self.m_bi[i][j+1]==n)chk=1;
		return chk;
	}
	function sswap(ai,aj){
		var an=self.m_bi[ai][aj];
	    for(var i=0;i<self.m_byNum;i++)
		for(var j=0;j<self.m_bxNum;j++){
			n=self.m_bi[i][j];
			temp=self.m_bi[i][j];
			self.m_bi[i][j]=self.m_bi[ai][aj];
			self.m_bi[ai][aj]=temp;
			if(cchk(an,i,j)==0 && cchk(n,ai,aj)==0){
				return 1;
			}
			temp=self.m_bi[i][j];
			self.m_bi[i][j]=self.m_bi[ai][aj];
			self.m_bi[ai][aj]=temp;
			
		}
		return 0;
	}
	var sswapCnt=0,sswapChk=0,zsswapChk=0;
	do{
		zsswapChk=sswapChk;
		sswapChk=0;
		for(var i=0;i<self.m_byNum;i++)
		for(var j=0;j<self.m_bxNum;j++){
			n=self.m_bi[i][j];
			if(cchk(n,i,j)==1){
				if(sswap(i,j)==0){
				
					sswapChk=1;
				}
			}
		}
		//if(sswapChk==1)sswapCnt++;
		if(zsswapChk==1 && sswapChk==1){
			alert('cannt');
			sswapChk='break';
			break;
		}
	}while(sswapChk==1);
	for(var i=0;i<self.m_byNum;i++)
	for(var j=0;j<self.m_bxNum;j++){
		n=self.m_bi[i][j];
		self.m_bid[i][j].expsn=n+'_'+(cchk(n,i,j)==0?'#':'.');
	    
	}
	

	 drawBoxes();
}
function makeData()
{
	self.m_bi=new Array(self.m_byNum);
	self.m_bid=new Array(self.m_byNum);
	for(var i=0;i<self.m_byNum;i++){
		self.m_bi[i]=new Array(self.m_bxNum);
		self.m_bid[i]=new Array(self.m_bxNum);
	}
	var n,chk=0,cnt=0;
	for(var i=0;i<self.m_byNum;i++)
	for(var j=0;j<self.m_bxNum;j++){
		self.m_bi[i][j]=Math.floor(cnt/2)%3;
		self.m_bid[i][j]=function (){};
	    cnt++;
	}
	var nx,ny,nx2,ny2,temp;
	
	for(var i=0;i<100;i++){
	    nx=Math.floor(Math.random()*self.m_bxNum);
	    ny=Math.floor(Math.random()*self.m_byNum);
	    nx2=Math.floor(Math.random()*self.m_bxNum);
	    ny2=Math.floor(Math.random()*self.m_byNum);
	    temp=self.m_bi[ny][nx];
	    self.m_bi[ny][nx]=self.m_bi[ny2][nx2];
	    self.m_bi[ny2][nx2]=temp;
	}
	
	function cchk(n,i,j){
	    
	    var chk=0;
		if(i>0)if(self.m_bi[i-1][j]==n)chk=1;
		if(i<self.m_byNum-1)if(self.m_bi[i+1][j]==n)chk=1;
		if(j>0)if(self.m_bi[i][j-1]==n)chk=1;
		if(j<self.m_bxNum-1)if(self.m_bi[i][j+1]==n)chk=1;
		return chk;
	}
	function sswap(ai,aj){
		var an=self.m_bi[ai][aj];
	    for(var i=0;i<self.m_byNum;i++)
		for(var j=0;j<self.m_bxNum;j++){
			n=self.m_bi[i][j];
			temp=self.m_bi[i][j];
			self.m_bi[i][j]=self.m_bi[ai][aj];
			self.m_bi[ai][aj]=temp;
			if(cchk(an,i,j)==0 && cchk(n,ai,aj)==0){
				return 1;
			}
			temp=self.m_bi[i][j];
			self.m_bi[i][j]=self.m_bi[ai][aj];
			self.m_bi[ai][aj]=temp;
			
		}
		return 0;
	}
	
	var sswapCnt=0,sswapChk=0,zsswapChk=0;
	do{
		zsswapChk=sswapChk;
		sswapChk=0;
		for(var i=0;i<self.m_byNum;i++)
		for(var j=0;j<self.m_bxNum;j++){
			n=self.m_bi[i][j];
			if(cchk(n,i,j)==1){
				if(sswap(i,j)==0){
				
					sswapChk=1;
				}
			}
		}
		//if(sswapChk==1)sswapCnt++;
		if(zsswapChk==1 && sswapChk==1){
			alert('cannt');
			sswapChk='break';
			break;
		}
	}while(sswapChk==1);
	for(var i=0;i<self.m_byNum;i++)
	for(var j=0;j<self.m_bxNum;j++){
		n=self.m_bi[i][j];
		self.m_bid[i][j].expsn=n+'_'+(cchk(n,i,j)==0?'#':'.');
	    
	}
	
}
makeData();
function box(x,y)
{
var c=document.getElementById("myCanvas");
var context=c.getContext("2d");
//context.fillRect(20,20,150,100);
context.beginPath();
      context.rect(x, y,self.m_boxXS , self.m_boxYS);
      context.fillStyle = 'yellow';
      context.fill();
      context.lineWidth = 3;
      context.strokeStyle = 'green';
      context.stroke();
	  context.closePath();
}
function boxp(x,y,num)
{
	var c=document.getElementById("myCanvas");
	var ctx=c.getContext("2d");
	box(x,y);
	ctx.beginPath();

	ctx.font = '18pt Calibri';
    ctx.fillStyle = 'black';
    //ctx.fillText("a가나다", x, y+self.m_boxYS/2+9+9);
    ctx.fillText(num, x+self.m_boxXS/2, y+self.m_boxYS/2);

	ctx.closePath();

}
function drawBoxes()
{
	var x,y;
	var xs,ys;
	xs=self.m_boxXS*10/9;
	ys=self.m_boxYS*10/9;
	for(var i=0;i<self.m_bxNum;i++){
		for(var j=0;j<self.m_byNum;j++){
			x=i*xs;
			y=j*ys;
			boxp(100+x,100+y,self.m_bid[j][i].expsn);
			
			
		}
	}

}	 
 drawBoxes();
 };
 var m_linebig=new linebig();
</script>
<script>
function is_mobile(){
    var rtn = false;
    var mobileInfo = new Array('Android', 'iPhone', 'iPod', 'BlackBerry', 'Windows CE', 'SAMSUNG', 'LG', 'MOT', 'SonyEricsson');
    for (var info in mobileInfo){
        if (navigator.userAgent.match(mobileInfo[info]) != null){
            rtn = true;
            break;
        }
    }
    return rtn;
}
</script>

</body>
</html>
